# Chrobelias - Chrobak normal form-based Exponential Linear Integer Arithmetic Solver

__ChrobELIAS__ is an smt-solver for the existential **E**xponential-**L**inear **I**nteger **A**rithmetic with regular constraints $\langle\mathbb{N}; 0, 1, +, x\mapsto 2^x, \mathscr{R}, =,\leq\rangle$. 
The solver implements the decision procedure for [existential generalised Semёnov arithmetic](https://arxiv.org/abs/2306.14593) 
from [Quantifier Elimination for Regular Integer Linear-Exponential Programming](https://www.ti.inf.uni-due.de/misc/lics2025/preprints/Starchak.pdf), 
where Chrobak Normal Form of sub-NFAs is used to linearise exponential occurrences of the variables.

## Building
To build the project you need the following dependencies to be installed:
- OPam - OCaml package manager.
- OCaml >5.0.

The dependencies can be installed using the bash commands
```bash
# Installing OCaml package manager and OCaml 5.2.
bash -c "sh <(curl -fsSL https://opam.ocaml.org/install.sh)"
opam switch create 5.2.0+flambda --packages=ocaml-variants.5.2.0+options,ocaml-option-flambda --yes
```
ChrobELIAS is built as follows:

```bash
# Installing project dependencies.
opam install . --deps-only --with-test

# Building the project and its tests.
opam exec -- dune build @check @all
```

The executable binary is available in the `_build` dir.

## Usage

Supports `.smt2` files in `QF_LIA` and exponents via the binary `exp` function symbol.

```bash
./_build/default/bin/chro.exe <path-to-smt2-file>
```

Simple `.smt2` files for ChrobELIAS can be found in [examples](https://github.com/Chrobelias/Chrobelias/tree/main/examples).

```bash
# Frobenius coin problem for 7 11 13
./_build/default/bin/chro.exe ./examples/fcp_7_11_13.smt2

# Proof ExEy y >= 0 & x = 2**y & x > 4.
./_build/default/bin/chro.exe ./examples/basic-exp-sat.smt2
```

## Acknowledgements

This repository contains unit-tests and examples based on the Frobenius coin problem benchmarks from the [SMT-LIB benchmark submission repository](https://github.com/SMT-LIB/benchmark-submission) licensed under [Creative-Commons 4.0](https://creativecommons.org/licenses/by/4.0/) generated by Vojtěch Havlena, Michal Hečko, Lukáš Holík, Ondřej Lengál. There are modified Frobenius coin problem benchmarks involving exponents.

Also, we use custom SMT-lib v2.6 `exp` syntax and examples from [SwInE](https://github.com/ffrohn/swine) 
by [Florian Frohn](https://ffrohn.github.io/) licensed under [LGPL v2.1](https://github.com/ffrohn/swine/blob/master/LICENSE).

## Bemchmarks

To clone benchmarks: `git submodule update --init`

The root `Makefile` contains commands to generate various dune files with benchmarks.
For example, `make genTPDB_ITS_Complexity` will generate many benchmarks in `tests/QF_LIA/LoAT/TPDP_ITS_Complexity`.
You can use `make -C  benchmarks/tests/QF_LIA/LoAT/TPDB_ITS_Complexity` to *autopromote* them.
(Autopromoting  after autogeneration of files is a good idea.)

You can run benchmarks if dune's profile 'benchmark' is specified.
It is done in this manner to make builds/tests faster.

To run a single benchmark try `dune b @benchmarks/tests/QF_LIA/LoAT/TPDB_ITS_Complexity/a.03.koat_0 --profile=benchmark`.
The expected output is located in `benchmarks/tests/QF_LIA/LoAT/TPDB_ITS_Complexity/a.03.koat_0.t`, and running a benchmark will report if output differs.